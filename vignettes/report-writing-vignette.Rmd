---
title: "Report Writing"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{report-writing-vignette}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
  \usepackage[utf8]{inputenc}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.retina = 3,
  fig.width = 6,
  fig.asp = 0.618, 
  fig.align = "center",
  out.width = "90%"
)

options(warn = -1)
```

```{r setup, include = FALSE}
library(ratlas)
library(dplyr)
library(ggplot2)
library(english)
library(knitr)
library(kableExtra)
```

## Creating a New Project

When beginning a new report, the first step is to create a new project
in RStudio. This can be done by clicking: 
  
<center> **File > New Project > New Directory > New Project** </center>

![](images/menu_sc.png)
![](images/new_dir_sc.png)
![](images/new_project_sc.png)

From there, specify the project name and the directory where you would like to 
save the project for the new report. To lessen confusion later, it is usually 
worthwhile to save each report in its own directory/project so that you can 
quickly and easily find the report at a later date.

## Writing the Setup Chunk

The Setup Chunk is where the default settings for your report are set. The Setup Chunk will be automatically created for you. The only editing of the Setup Chunk will be 

- Adding necessary packages to the `needed_packages` variable
- Setting a global ggplot2 theme using the `set_theme()` function

Setting a global ggplot2 theme using the `set_theme()` function can be done by adding a function such as `set_theme("Arial Narrow")` or `set_theme("Montserrat")` to the Setup Chunk.

## Create and Cross Reference Tables

Tables can be created using the kable function in the kableExtra package in R. 

Creating tables is relatively simple. The kable package takes an existing 
dataset and places the vectors (i.e., columns in the data frame) into columns in
the table. 


```{r filtered_iris, echo = TRUE, eval = TRUE}
temp <- iris %>%
  filter(Petal.Length > 6.0) %>%
  arrange(desc(Petal.Length))

kable(x = temp, digits = 1, col.names = c("Sepal Length", "Sepal Width", 
                                          "Petal Length", "Petal Width", 
                                          "Species"), 
      align = "c", caption = "A table of irises with long petals", 
      booktabs = TRUE, format.args = list(big.mark = ","))
```

Additional information about the kableExtra package and cross referencing tables can be found [here](https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_html.html).

## Create and Cross Reference Figures

Figures can be created using the ggplot2 package in R. An example is included below.

```{r iris-fig}
iris %>%
  ggplot(aes(x = Petal.Length, y = Sepal.Length, color = Species)) +
  geom_point() +
  labs(x = "Petal Length", y = "Sepal Length") + 
  theme_atlas()
```

Additional information about the ggplot2 package and cross referencing figures can be found [here](https://ggplot2.tidyverse.org/).

## Best Practices

Because of how files within an R project are linked to one another, the best practice is to create a file structure that is organized and references directories without hard coding the directories. 

Four commonly used project directories, which may be useful, are:

- R/
- data-raw/
- data/
- output/

The `here()` function is designed to reference the directory where you have saved your project file, which is why the project file should always be created first and .R and .Rmd files created afterwards. 

As an example, the following code will create the "R" directory in your project folder: `dir.create(here("R"))`.

More information about best practices in file structure in R and the here package can be found [here](https://www.r-bloggers.com/structuring-r-projects/). 

## Tips and Tricks

Code can be evaluated in-line so that the results are presented in the sentence without special formatting. For example, the code `` `r mean(iris$Petal.Length)` `` evaluates to 
`r mean(iris$Petal.Length)`. More information on in-line code can be found [here](https://bookdown.org/yihui/rmarkdown/r-code.html).

The `English` package can be used to manipulate words and numbers into grammatically correct syntax. For example, `` `r knitr::combine_words(colnames(iris))` `` becomes `r knitr::combine_words(colnames(iris))`. More information on the `English` package can be found [here](https://www.rdocumentation.org/packages/english/versions/1.1-4).
