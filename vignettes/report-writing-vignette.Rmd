---
title: "Writing a Report With ratlas"
output:
  bookdown::html_document2:
    base_format: rmarkdown::html_vignette
    number_sections: false
pkgdown:
  as_is: true
vignette: >
  %\VignetteIndexEntry{report-writing-vignette}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
  \usepackage[utf8]{inputenc}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.retina = 3,
  fig.width = 6,
  fig.asp = 0.618, 
  fig.align = "center",
  out.width = "90%"
)

options(warn = -1)
```

```{r setup, include = FALSE}
library(ratlas)
library(dplyr)
library(ggplot2)
library(english)
library(knitr)
library(kableExtra)
library(here)
```

This vignette walks through the process of creating a new topic guide, technical report, or research report using R Markdown. We also suggest best practices for organizing your report files, and give some tips and tricks for formatting text.

## Creating a New Tech Report or Topic Guide

When beginning a new report, the first step is to create a new project in RStudio. This can be done by clicking: 
  
<center> **File > New Project > New Directory > Tech Report using ratlas** </center>

Please note, this example will use the terminology for creating a new tech report, but the same steps can be used to create a new topic guide.

```{r menu-sc, echo = FALSE}
    knitr::include_graphics(here("vignettes/images/new-project.png"))
```

```{r new-dir-sc, echo = FALSE}
    knitr::include_graphics(here("vignettes/images/new-directory.png"))
```

```{r new-proj-sc, echo = FALSE}
    knitr::include_graphics(here("vignettes/images/new_project_sc.PNG"))
```

Then, specify the project name and the directory where you would like to save the project for the new report. To lessen confusion later, it is usually worthwhile to save each report as a new project in its own directory so that you can quickly and easily find the report at a later date.

## Knitting the R Markdown File

Before altering the template file, knit the template R markdown file to ensure the system is working correctly. The R markdown file can be knitted by clicking the "Knit" button (displayed below).

```{r knit-sc, echo = FALSE}
    knitr::include_graphics(here("vignettes/images/knit_sc.PNG"))
```

## Altering the Setup Chunk

The Setup Chunk (displayed below) is where the default settings for your report are specified. 

```{r setup-chunk-sc, echo = FALSE}
    knitr::include_graphics(here("vignettes/images/setup_chunk_sc.PNG"))
```

The Setup Chunk will be automatically created for you. The only editing of the Setup Chunk will be to

- Add necessary packages to the `needed_packages` variable
- Set a global ggplot2 theme using the `set_theme()` function

Setting a global ggplot2 theme using the `set_theme()` function can be done by adding a function such as `set_theme("Arial Narrow")` or `set_theme("Montserrat")` to the Setup Chunk.

## Create and Cross Reference Tables

Tables can be created using the `kable()` function in the `kableExtra` package in R. 

To create a table, the `kableExtra` package takes an existing data frame (or tibble) and places the vectors (i.e., columns) into columns of the table. 

```{r filtered_iris, echo = TRUE, eval = TRUE}
temp <- iris %>%
  filter(Petal.Length > 6.0) %>%
  arrange(desc(Petal.Length))

kable(x = temp, digits = 1, col.names = c("Sepal Length", "Sepal Width", 
                                          "Petal Length", "Petal Width", 
                                          "Species"), 
      align = "c", caption = "A table of irises with long petals", 
      booktabs = TRUE, format.args = list(big.mark = ","))
```

Additional information about the kableExtra package and cross referencing tables can be found [here](https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_html.html).

## Create and Cross Reference Figures

Figures can be created using the `ggplot2` package in R. An example is included below.

```{r iris-fig}
iris %>%
  ggplot(aes(x = Petal.Length, y = Sepal.Length, color = Species)) +
  geom_point() +
  labs(x = "Petal Length", y = "Sepal Length") + 
  theme_atlas()
```

Additional information about the `ggplot2` package and cross referencing figures can be found [here](https://ggplot2.tidyverse.org/).

## Best Practices

Because of how files within an R project are linked to one another, the best practice is to create a file structure that is organized and references directories without hard coding the directories. 

Four commonly used project directories, which may be useful, are:

- R/
- data-raw/
- data/
- output/

The `here()` function is designed to reference the directory where you have saved your project file, which is why it is recommended to create the project file first, followed by any needed .R or .Rmd files. 

As an example, the following code will create the "R" directory in your project folder: `dir.create(here("R"))`.

More information about best practices in file structure in R and the here package can be found [here](https://www.r-bloggers.com/structuring-r-projects/). 

## Tips and Tricks

Code can be evaluated in-line so that the results are presented in the sentence without special formatting. For example, the code `` `r mean(iris$Petal.Length)` `` evaluates to 
`r mean(iris$Petal.Length)`. More information on in-line code can be found [here](https://bookdown.org/yihui/rmarkdown/r-code.html).

The `English` package can be used to manipulate words and numbers into grammatically correct syntax. For example, `` `r knitr::combine_words(colnames(iris))` `` becomes `r knitr::combine_words(colnames(iris))`. More information on the `English` package can be found [here](https://www.rdocumentation.org/packages/english/versions/1.1-4).
